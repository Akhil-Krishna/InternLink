{% extends "base.html" %}
{% block content %}
<div class="container my-5">
  <h2 class="mb-4">Edit Profile</h2>

  <form method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
    <div class="row">
      <!-- Profile picture -->
      <div class="col-md-4 text-center mb-4">
        <img src="{{ url_for('static', filename='uploads/images/' + profile.profile_image) }}"
             class="img-thumbnail rounded-circle"
             style="width: 150px; height: 150px; object-fit: cover;">
        <div class="mt-2">
          <input type="file" name="profile_pic" class="form-control">
          <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" name="remove_pic" id="remove_pic">
            <label class="form-check-label" for="remove_pic">Remove current picture</label>
          </div>
        </div>
      </div>

      <!-- Main form -->
      <div class="col-md-8">
        <div class="row g-3">
          <div class="col-md-6">
            <label for="first_name" class="form-label">First Name</label>
            <input name="first_name" value="{{ profile.first_name }}" class="form-control" required>
          </div>

          <div class="col-md-6">
            <label for="last_name" class="form-label">Last Name</label>
            <input name="last_name" value="{{ profile.last_name }}" class="form-control" required>
          </div>

          {% if role == 'admin' %}
          <div class="col-12">
            <label for="email" class="form-label">Email</label>
            <input name="email" value="{{ profile.email }}" class="form-control" required>
          </div>
          {% endif %}

          {% if role == 'student' %}
          <div class="col-md-6">
            <label for="university" class="form-label">University</label>
            <input name="university" value="{{ profile.university }}" class="form-control" required>
          </div>

          <div class="col-md-6">
            <label for="course" class="form-label">Course</label>
            <input name="course" value="{{ profile.course }}" class="form-control" required>
          </div>

          <div class="col-12">
            <label for="resume" class="form-label">Upload Resume (PDF/DOC)</label>
            <input type="file" name="resume" class="form-control">
            {% if profile.resume_path %}
            <small>Current: {{ profile.resume_path }}</small>
            {% endif %}
          </div>
          {% endif %}

          {% if role == 'employer' %}
          <div class="col-12">
            <label for="company_name" class="form-label">Company Name</label>
            <input name="company_name" value="{{ profile.company_name }}" class="form-control" required>
          </div>

          <div class="col-12">
            <label for="company_description" class="form-label">Company Description</label>
            <textarea name="company_description" class="form-control" rows="3">{{ profile.company_description }}</textarea>
          </div>

          <div class="col-md-6">
            <label for="website" class="form-label">Website</label>
            <input name="website" value="{{ profile.website }}" class="form-control">
          </div>

          <div class="col-md-6">
            <label for="logo" class="form-label">Upload Logo</label>
            <input type="file" name="logo" class="form-control">
            {% if profile.logo_path %}
            <small>Current: {{ profile.logo_path }}</small>
            {% endif %}
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Change password -->
    <hr class="my-4">
    <h5>Change Password (optional)</h5>
    <div class="row g-3">
      <div class="col-md-6">
        <label for="new_password" class="form-label">New Password</label>
        <input type="password" name="new_password" class="form-control" placeholder="Min 8 chars, letters & numbers">
      </div>
      <div class="col-md-6">
        <label for="confirm_password" class="form-label">Confirm New Password</label>
        <input type="password" name="confirm_password" class="form-control">
      </div>
    </div>

    <div class="mt-4">
      <button type="submit" class="btn btn-primary">Save Changes</button>
      <a href="{{ url_for('profile') }}" class="btn btn-secondary">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}
